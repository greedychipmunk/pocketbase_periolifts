/// <reference path="../pb_data/types.d.ts" />

migrate((app) => {
  // Create test exercises (these don't depend on users)
  const exercisesCollection = app.findCollectionByNameOrId("exercises")
  
  const exercises = [
    {
      name: "Push-ups",
      category: "strength",
      description: "A bodyweight exercise that targets chest, shoulders, and triceps",
      muscle_groups: ["chest", "triceps", "shoulders"],
      is_custom: false
    },
    {
      name: "Squats",
      category: "strength", 
      description: "A compound exercise that targets quadriceps, glutes, and hamstrings",
      muscle_groups: ["quadriceps", "glutes", "hamstrings"],
      is_custom: false
    },
    {
      name: "Plank",
      category: "core",
      description: "An isometric core strengthening exercise",
      muscle_groups: ["core", "shoulders"],
      is_custom: false
    },
    {
      name: "Lunges",
      category: "strength",
      description: "A unilateral leg exercise targeting quadriceps, glutes, and stabilizers",
      muscle_groups: ["quadriceps", "glutes", "hamstrings", "calves"],
      is_custom: false
    },
    {
      name: "Jumping Jacks",
      category: "cardio",
      description: "A simple cardiovascular exercise",
      muscle_groups: ["full_body"],
      is_custom: false
    },
    {
      name: "Burpees",
      category: "cardio",
      description: "A full-body exercise combining squat, push-up, and jump",
      muscle_groups: ["full_body"],
      is_custom: false
    },
    {
      name: "Mountain Climbers",
      category: "cardio",
      description: "A dynamic exercise that combines cardio and core strengthening",
      muscle_groups: ["core", "shoulders", "legs"],
      is_custom: false
    },
    {
      name: "Bicycle Crunches",
      category: "core",
      description: "A core exercise targeting the obliques and rectus abdominis",
      muscle_groups: ["core", "obliques"],
      is_custom: false
    },
    {
      name: "Wall Sit",
      category: "strength",
      description: "An isometric exercise targeting quadriceps and glutes",
      muscle_groups: ["quadriceps", "glutes"],
      is_custom: false
    },
    {
      name: "High Knees",
      category: "cardio",
      description: "A cardio exercise that improves coordination and leg strength",
      muscle_groups: ["legs", "core"],
      is_custom: false
    }
  ]

  exercises.forEach(exerciseData => {
    const exercise = new Record(exercisesCollection)
    exercise.set("name", exerciseData.name)
    exercise.set("category", exerciseData.category)
    exercise.set("description", exerciseData.description)
    exercise.set("muscle_groups", exerciseData.muscle_groups)
    exercise.set("is_custom", exerciseData.is_custom)
    app.save(exercise)
  })

  return null
}, (app) => {
  // Down migration - remove test exercises
  try {
    const exercisesCollection = app.findCollectionByNameOrId("exercises")
    const testExercises = app.findRecordsByFilter(exercisesCollection.id, "is_custom = false")
    testExercises.forEach(record => app.delete(record))
  } catch (e) {
    // Ignore errors in down migration
  }
  
  return null
})